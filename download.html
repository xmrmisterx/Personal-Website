<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Download CSV</title>
</head>

<div class="topnav">

  <a href="index.html">Home</a>
  <a href="Kilimanjaro.html">Kilimanjaro</a>
  <a href="Mount Kenya.html">Mount Kenya</a>
  <a href="Mount Elbrus.html">Mount Elbrus</a>
  <a href="Dykh-Tau.html">Dykh-Tau</a>
  <a href="Denali.html">Denali</a>
  <a href="Mount Logan.html">Mount Logan</a>
  <a href="Mount Aconcagua.html">Mount Aconcagua</a>
  <a href="Ojos del Salado.html">Ojos del Salado</a>
  <a href="Mount Everest.html">Mount Everest</a>
  <a href="K2.html">K2</a>
  <a href="Vinson Massif.html">Vinson Massif</a>
  <a href="Mount Tyree.html">Mount Tyree</a>
  <a href="Mount Kosciuszko.html">Mount Kosciuszko</a>
  <a href="Mount Townsend.html">Mount Townsend</a>
  <a class="active" href="download.html">Download</a>

</div>

<body>
    <br>
    <br>
    This is a sample of the downloaded CSV file when viewed with Excel.
    <br>
    <br>
    <br>
    <img src="Mountain CSV Table.png" alt="csv sample">
    <br>
    <br>
    <br>

    <button id="btn">Download CSV</button>

    <link rel="stylesheet" href="styles.css">
    <script>

      function sendRequest() {

        // GET request part

        let request_obj = '[{"CONTINENT":"Africa","MOUNTAIN":"1. Kilimanjaro (Tanzania, 19,341 ft)"},{"CONTINENT":"Africa","MOUNTAIN":"2. Mount Kenya (Kenya, 17,057 ft)"},{"CONTINENT":"Europe","MOUNTAIN":"1. Mount Elbrus (Russia, 18,510 ft)"},{"CONTINENT":"Europe","MOUNTAIN":"2. Dykh-Tau (Russia, 17,077 ft)"},{"CONTINENT":"North America","MOUNTAIN":"1. Denali (Alaska, 20,310 ft)"},{"CONTINENT":"North America","MOUNTAIN":"2. Mount Logan (Canada, 19,551 ft)"},{"CONTINENT":"South America","MOUNTAIN":"1. Mount Aconcagua (Argentina, 22,837 ft)"},{"CONTINENT":"South America","MOUNTAIN":"2. Ojos del Salado (Argentina/Chile, 22,615 ft)"},{"CONTINENT":"Asia","MOUNTAIN":"1. Mount Everest (Nepal, 29,032 ft)"},{"CONTINENT":"Asia","MOUNTAIN":"2. K2 (China/Pakistan, 28,251 ft)"},{"CONTINENT":"Antartica","MOUNTAIN":"1. Vinson Massif (South Pole, 16,050 ft)"},{"CONTINENT":"Antartica","MOUNTAIN":"2. Mount Tyree (South Pole, 15,919 ft)"},{"CONTINENT":"Australia","MOUNTAIN":"1. Mount Kosciuszko (New South Wales, 7,310 ft)"},{"CONTINENT":"Australia","MOUNTAIN":"2. Mount Townsend (New South Wales, 7,247 ft)"}]';
        var req = new XMLHttpRequest;
        req.open("GET", 'http://flip1.engr.oregonstate.edu:8523/csvmaker?j=' + request_obj, false);
        req.send(null);
        console.log("reponse text: " + req.responseText);

        // create new document element

        var anchor = document.createElement('a');

        // set its href to a csv encoded request response text

        anchor.href = 'data:attachment/csv;charset=utf-8,' + encodeURI(req.responseText);
        anchor.target = '_blank';
        anchor.download = 'mountain.csv';
        anchor.style.display = 'none';

        // attach the new document element to the document and click the button

        document.body.appendChild(anchor);
        anchor.click();
      }

      // add event listener to download button

      document.getElementById("btn").addEventListener("click", sendRequest);

    </script>
</body>

</html>